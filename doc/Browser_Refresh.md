# Browser Tab Refresher ì„¤ê³„ ë¬¸ì„œ

## ìµœì‹  ì—…ë°ì´íŠ¸ (2024-04-11)

### UI ê°œì„ 

- íƒ­ ê´€ë¦¬ ì˜ì—­ í™•ì¥ (ì „ì²´ ì°½ì˜ 57%)
  - ìŠ¤ìº”ëœ íƒ­ ëª©ë¡: ìµœì†Œ ë†’ì´ 200px
  - ê´€ë¦¬ ì¤‘ì¸ íƒ­ ëª©ë¡: ìµœì†Œ ë†’ì´ 200px
- ë ˆì´ì•„ì›ƒ ë¹„ìœ¨ ìµœì í™”
  - íƒ­ ê´€ë¦¬ ì˜ì—­: 4
  - ë¸Œë¼ìš°ì € ì„ íƒ: 1
  - ìƒˆë¡œê³ ì¹¨ ì„¤ì •: 1
  - ìƒíƒœ ì •ë³´: 1

### ë¸Œë¼ìš°ì € ì§€ì› í™•ì¥

- ì§€ì› ë¸Œë¼ìš°ì €
  - Google Chrome
  - Mozilla Firefox
  - Microsoft Edge
  - Safari
- OSë³„ ë¸Œë¼ìš°ì € ì²˜ë¦¬
  - Windows: pygetwindow ê¸°ë°˜ ì°½ ê´€ë¦¬
  - macOS: AppleScript ê¸°ë°˜ ì°½ ê´€ë¦¬
  - Linux: ê¸°ë³¸ êµ¬í˜„ (í–¥í›„ í™•ì¥ ì˜ˆì •)

### ì½”ë“œ êµ¬ì¡° ê°œì„ 

- MainWindow í´ë˜ìŠ¤ ë¦¬íŒ©í† ë§
  - ìƒì„±ì ë§¤ê°œë³€ìˆ˜ ìˆ˜ì •
  - íƒ­ ê´€ë¦¬ì ì˜ì¡´ì„± ê°œì„ 
- TabManager í´ë˜ìŠ¤ í™•ì¥
  - ë¸Œë¼ìš°ì €ë³„ ì°½ ì²˜ë¦¬ ë¡œì§ ì¶”ê°€
  - íƒ­ ì •ë³´ êµ¬ì¡° ìµœì í™”
- ì˜¤ë¥˜ ì²˜ë¦¬ ê°•í™”
  - ë¸Œë¼ìš°ì € ì „í™˜ ì‹œ ìƒíƒœ ì´ˆê¸°í™”
  - ì˜ˆì™¸ ìƒí™© ì²˜ë¦¬ ê°œì„ 

## êµ¬ì„± ìš”ì†Œ

### 1. GUI (gui.py)

- ë©”ì¸ ìœˆë„ìš° êµ¬ì„±
  - ë¸Œë¼ìš°ì € ì„ íƒ ì˜ì—­
  - íƒ­ ê´€ë¦¬ ì˜ì—­ (ìŠ¤ìº”/ê´€ë¦¬ ëª©ë¡)
  - ìƒˆë¡œê³ ì¹¨ ì„¤ì •
  - ìƒíƒœ ì •ë³´ í‘œì‹œ
- ì‚¬ìš©ì ìƒí˜¸ì‘ìš© ì²˜ë¦¬
  - íƒ­ ìŠ¤ìº” ë° ì„ íƒ
  - ìƒˆë¡œê³ ì¹¨ ì„¤ì •
  - ìƒíƒœ ì—…ë°ì´íŠ¸

### 2. íƒ­ ê´€ë¦¬ì (tab_manager.py)

- ë¸Œë¼ìš°ì € ì°½ ê´€ë¦¬
  - ë¸Œë¼ìš°ì €ë³„ ì°½ ê°ì§€
  - íƒ­ ì •ë³´ ì¶”ì¶œ
  - OSë³„ ìµœì í™”
- ìƒˆë¡œê³ ì¹¨ ê¸°ëŠ¥
  - ìë™ ìƒˆë¡œê³ ì¹¨
  - ì˜ˆì•½ ìƒˆë¡œê³ ì¹¨
  - ìˆ˜ë™ ìƒˆë¡œê³ ì¹¨

### 3. ì‹œê°„ ì„¤ì • ë‹¤ì´ì–¼ë¡œê·¸ (time_schedule_dialog.py)

- ìƒˆë¡œê³ ì¹¨ ì‹œê°„ ì„¤ì •
- ë‹¤ì¤‘ ì‹œê°„ ê´€ë¦¬
- ì‹œê°„ ëª©ë¡ í‘œì‹œ

## ë°ì´í„° êµ¬ì¡°

### íƒ­ ì •ë³´

```json
{
  "id": "ì°½ ê³ ìœ  ID",
  "name": "íƒ­ ì´ë¦„",
  "title": "ì°½ ì œëª©"
}
```

### ì„¤ì • íŒŒì¼ (tab_handles.json)

```json
{
  "browser_type": "ë¸Œë¼ìš°ì € ì¢…ë¥˜",
  "managed_tabs": [
    {
      "id": "ì°½ ID",
      "name": "íƒ­ ì´ë¦„"
    }
  ],
  "scheduled_refreshes": {
    "ì°½ ID": ["HH:MM", "HH:MM"]
  }
}
```

## ì£¼ìš” ê¸°ëŠ¥ íë¦„

### 1. íƒ­ ìŠ¤ìº” ë° ì¶”ê°€

1. ë¸Œë¼ìš°ì € ì„ íƒ
2. íƒ­ ìŠ¤ìº” ì‹¤í–‰
3. ìŠ¤ìº”ëœ íƒ­ ëª©ë¡ í‘œì‹œ
4. íƒ­ ì„ íƒ ë° ì¶”ê°€
5. ê´€ë¦¬ ëª©ë¡ ì—…ë°ì´íŠ¸

### 2. ìƒˆë¡œê³ ì¹¨ ì‹¤í–‰

1. ìë™ ìƒˆë¡œê³ ì¹¨
   - ê°„ê²© ì„¤ì •
   - íƒ€ì´ë¨¸ ê¸°ë°˜ ì‹¤í–‰
2. ì˜ˆì•½ ìƒˆë¡œê³ ì¹¨
   - ì‹œê°„ ì„¤ì •
   - ìŠ¤ì¼€ì¤„ ê¸°ë°˜ ì‹¤í–‰
3. ìˆ˜ë™ ìƒˆë¡œê³ ì¹¨
   - ì„ íƒ íƒ­ ìƒˆë¡œê³ ì¹¨
   - ì „ì²´ íƒ­ ìƒˆë¡œê³ ì¹¨

### 3. ìƒíƒœ ê´€ë¦¬

1. ìƒˆë¡œê³ ì¹¨ ìƒíƒœ
   - ë‹¤ìŒ ì˜ˆì • ì‹œê°„
   - ë§ˆì§€ë§‰ ì‹¤í–‰ ì‹œê°„
2. íƒ­ ìƒíƒœ
   - ì„ íƒëœ íƒ­ ì •ë³´
   - ì˜ˆì•½ëœ ì‹œê°„ ëª©ë¡
3. ì˜¤ë¥˜ ì²˜ë¦¬
   - ìƒíƒœë°” ë©”ì‹œì§€
   - ì˜¤ë¥˜ ëŒ€í™”ìƒì

## í–¥í›„ ê°œì„  ì‚¬í•­

1. Linux ì§€ì› ê°•í™”
2. ë¸Œë¼ìš°ì € í”ŒëŸ¬ê·¸ì¸ ì—°ë™
3. ê³ ê¸‰ ìŠ¤ì¼€ì¤„ë§ ê¸°ëŠ¥
4. ì›ê²© ì œì–´ ê¸°ëŠ¥
5. ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ì¶”ê°€

---

# PyAutoGUIì™€ PyGetWindowë¥¼ í™œìš©í•œ ì§ì ‘ì ì¸ ë¸Œë¼ìš°ì € íƒ­ ë¦¬í”„ë ˆì‹œ ì „ëµ

ë¸Œë¼ìš°ì € íƒ­ì„ íš¨ê³¼ì ìœ¼ë¡œ ë¦¬í”„ë ˆì‹œí•˜ëŠ” ìµœì ì˜ ë°©ë²•ì€ ë¸Œë¼ìš°ì € ì°½ì„ ì§ì ‘ ì œì–´í•˜ëŠ” ì ‘ê·¼ë²•ì…ë‹ˆë‹¤. ìµœì¢… ê²°ê³¼ë¬¼ì€ ë§¥ê³¼ ìœˆë„ìš°ì—ì„œ ëª¨ë‘ ì‹¤í–‰ ê°€ëŠ¥í•˜ë©°, ì‚¬ìš©ìê°€ í¸í•˜ê²Œ ì›í•˜ëŠ” ì°½ì„ ì§€ì •í•  ìˆ˜ ìˆëŠ” í˜•íƒœì˜ í”„ë¡œê·¸ë¨ìœ¼ë¡œ ê°œë°œí–ˆìŠµë‹ˆë‹¤. ë‹¤ìŒì€ ì´ë¥¼ ë‹¨ê³„ë³„ë¡œ ëª…í™•í•˜ê²Œ ì„¤ëª…í•©ë‹ˆë‹¤.

---

## ğŸ“Œ íƒ­ ë¦¬í”„ë ˆì‹œ ì „ëµ ê°œìš”

ë¸Œë¼ìš°ì € íƒ­ì„ ë¦¬í”„ë ˆì‹œí•˜ê¸° ìœ„í•´ PyAutoGUIì™€ PyGetWindowë¥¼ í™œìš©í•˜ì—¬ ì‹¤í–‰ ì¤‘ì¸ ë¸Œë¼ìš°ì € ì°½ì„ ì§ì ‘ ì œì–´í•©ë‹ˆë‹¤. ì´ ì ‘ê·¼ ë°©ì‹ì€ ì›ê²© ë””ë²„ê¹… ëª¨ë“œ ì—†ì´ë„ ë¹ ë¥´ê³  íš¨ìœ¨ì ìœ¼ë¡œ ì‘ë™í•©ë‹ˆë‹¤.

> **í•µì‹¬ ì „ëµ**: ë¸Œë¼ìš°ì € ì°½ ì‹ë³„ â†’ í™œì„±í™” â†’ ë¦¬í”„ë ˆì‹œ í‚¤ (F5/Cmd+R) ì „ì†¡ â†’ ê²°ê³¼ í™•ì¸

---

## ğŸš€ ë‹¨ê³„ë³„ êµ¬í˜„ ë°©ë²•

### 1ï¸âƒ£ ë¸Œë¼ìš°ì € ì°½ ì‹ë³„ ë° ê´€ë¦¬

Windowsì™€ macOSì—ì„œ ì‹¤í–‰ ì¤‘ì¸ Chrome ë˜ëŠ” Edge ë¸Œë¼ìš°ì € ì°½ì„ ì‹ë³„í•©ë‹ˆë‹¤:

```python
import pygetwindow as gw

# Windowsì—ì„œ ë¸Œë¼ìš°ì € ì°½ ì°¾ê¸°
chrome_windows = gw.getWindowsWithTitle('Chrome')
edge_windows = gw.getWindowsWithTitle('Edge')
```

macOSì—ì„œëŠ” AppleScriptë¥¼ í™œìš©í•œ ë°©ì‹ë„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤:

```python
import subprocess

def get_chrome_windows_macos():
    script = '''
    tell application "Google Chrome"
        get every window
    end tell
    '''
    result = subprocess.run(['osascript', '-e', script], capture_output=True, text=True)
    # ê²°ê³¼ íŒŒì‹± ë¡œì§
```

### 2ï¸âƒ£ ì°½ ì •ë³´ JSON íŒŒì¼ë¡œ ì €ì¥

ì‹ë³„ëœ ì°½ ì •ë³´ë¥¼ JSON íŒŒì¼ë¡œ ì €ì¥í•˜ì—¬ ê´€ë¦¬í•©ë‹ˆë‹¤.

```json
{
  "managed_tabs": [
    {
      "name": "example_tab_1",
      "window_title": "Example Page - Google Chrome",
      "platform": "windows"
    }
  ]
}
```

Python ì½”ë“œë¡œ ì €ì¥ ë° ë¡œë“œ:

```python
import json

# ì €ì¥
with open("tab_handles.json", "w") as f:
    json.dump(tab_info, f, indent=2)

# ë¶ˆëŸ¬ì˜¤ê¸°
with open("tab_handles.json", "r") as f:
    managed_tabs = json.load(f)["managed_tabs"]
```

### 3ï¸âƒ£ ì§ì ‘ í‚¤ ì…ë ¥ì„ í†µí•œ ë¦¬í”„ë ˆì‹œ

PyAutoGUIë¥¼ í™œìš©í•´ í™œì„±í™”ëœ ì°½ì— í‚¤ ì…ë ¥ì„ ì „ì†¡í•˜ì—¬ ë¦¬í”„ë ˆì‹œí•©ë‹ˆë‹¤:

```python
import pyautogui
import platform

def refresh_window(window):
    window.activate()  # ì°½ í™œì„±í™”
    if platform.system() == 'Darwin':  # macOS
        pyautogui.hotkey('command', 'r')
    else:  # Windows
        pyautogui.press('f5')
```

### 4ï¸âƒ£ í¬ë¡œìŠ¤ í”Œë«í¼ ì§€ì›

ìš´ì˜ì²´ì œë³„ ìµœì í™”ëœ êµ¬í˜„ìœ¼ë¡œ Windowsì™€ macOS ëª¨ë‘ ì§€ì›í•©ë‹ˆë‹¤:

```python
def refresh_browser_tab(browser_name, tab_title):
    system = platform.system()

    if system == "Windows":
        windows = get_windows_by_browser(browser_name)
        for window in windows:
            if tab_title in window.title:
                refresh_window(window)
                return True

    elif system == "Darwin":  # macOS
        if browser_name.lower() == "chrome":
            return refresh_chrome_tab_macos(tab_title)
        # Edge ë° ê¸°íƒ€ ë¸Œë¼ìš°ì € ì§€ì› ë¡œì§
```

### 5ï¸âƒ£ í”„ë¡œê·¸ë¨ ì‹¤í–‰ í¸ì˜ì„± í™•ë³´

- PyQt ê¸°ë°˜ GUIë¡œ ê°œë°œí•˜ì—¬ ë¹„ê°œë°œìë„ ì‰½ê²Œ ì´ìš© ê°€ëŠ¥
- ìë™ ë¦¬í”„ë ˆì‹œ ê¸°ëŠ¥ (ì„¤ì • ê°€ëŠ¥í•œ ì‹œê°„ ê°„ê²©)
- ëª…ë ¹í–‰ ë§¤ê°œë³€ìˆ˜ ì§€ì› (`--browser`, `--debug`, `--refresh`, `--auto`)
- ì‹¤í–‰ íŒŒì¼(.exe, .app)ë¡œ íŒ¨í‚¤ì§•í•˜ì—¬ ë³„ë„ì˜ í™˜ê²½ì„¤ì • ì—†ì´ ì‹¤í–‰ ê°€ëŠ¥

---

## âš ï¸ ì£¼ì˜ì‚¬í•­ ë° ì¶”ê°€ íŒ

- ì°½ì´ ìµœì†Œí™”ëœ ê²½ìš° ìë™ìœ¼ë¡œ í™œì„±í™”í•˜ì—¬ ë¦¬í”„ë ˆì‹œ
- íŠ¹ì • ë¸Œë¼ìš°ì €ì—ì„œ ì‘ë™ì´ ì›í™œí•˜ì§€ ì•Šì„ ê²½ìš° ëŒ€ì²´ ë©”ì„œë“œ ì œê³µ
- ì‚¬ìš©ì ì„¤ì • ë° ë¸Œë¼ìš°ì € ëª©ë¡ ìœ ì§€ ê´€ë¦¬

---

## ğŸ“Œ ì „ëµì˜ ì£¼ìš” ì´ì 

- ë””ë²„ê·¸ ëª¨ë“œ í•„ìš” ì—†ì´ ë¹ ë¥¸ ì‹¤í–‰ ê°€ëŠ¥
- ë¸Œë¼ìš°ì € ì—°ê²° ëŒ€ê¸° ì‹œê°„ ì œê±°ë¡œ ì„±ëŠ¥ í–¥ìƒ
- ë§¥ê³¼ ìœˆë„ìš° ëª¨ë‘ ì§€ì›í•˜ëŠ” í¬ë¡œìŠ¤ í”Œë«í¼ ì§€ì›
- GUIë¥¼ í†µí•œ ì§ê´€ì ì¸ ì°½ ì„ íƒ ë° ê´€ë¦¬

---
